server:
  compression:
    enabled: true
  tomcat:
    max-connections: 50
    accesslog:
      enabled: true
      pattern: "%h %l %u %t %r %s %b %D %{Referer}i %{User-Agent}i %{Request-Source}i"
      prefix: access_log
      suffix: .log
      file-date-format: .yyyy-MM-dd
      rotate: true
      renameOnRotate: true
      max-days: 10
      directory: /var/log/ampairs/
    threads:
      max: 50
      min-spare: 10
    accept-count: 50
    connection-timeout: 30000
  port: 8080
logging:
  logback:
    rollingpolicy:
      max-history: 7
      max-file-size: 1000MB
  file:
    path: /var/log/ampairs/
    name: ${logging.file.path}production.log
  pattern:
    file: "%highlight(%-5level) [%date] [%thread] [%cyan(%logger{0})] : %message%n"
    console: "%highlight(%-5level) [%date] [%thread] [%cyan(%logger{0})]: %message%n"

spring:
  profiles:
    active: dev
  jackson:
    property-naming-strategy: SNAKE_CASE
  datasource:
    url: jdbc:mysql://ampairs-db.cxgs2q4wopd3.ap-south-1.rds.amazonaws.com:3306/ampairs_db
    username: admin
    password: I6AJrK2siCjaKHoDzw6W
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      pool-name: main-db-pool
      maximum-pool-size: 20
      minimum-idle: 10
      connection-timeout: 20000
      idle-timeout: 60000
      max-lifetime: 300000
      validation-timeout: 5000
      leak-detection-threshold: 300000
  jpa:
    hibernate:
      naming:
        physical-strategy: org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy
      ddl-auto: update
  cache:
    cache-names[0]: rate-limit-bucket
    caffeine:
      spec: maximumSize=10000,expireAfterAccess=900s
    jcache:
      provider: com.github.benmanes.caffeine.jcache.spi.CaffeineCachingProvider
    type: jcache
# bucket4j configuration removed - using custom comprehensive rate limiting service instead
# Rate limiting is now configured in application.security.rate-limiting section below
application:
  security:
    jwt:
      secret-key: 404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
      expiration: 86400000 # a day
      refresh-token:
        expiration: 15552000000 # 180 days

drees:
  stacktrace: true
debug: false

# Google reCAPTCHA v3 Configuration for Production
google:
  recaptcha:
    enabled: ${RECAPTCHA_ENABLED:true}
    secret-key: ${RECAPTCHA_SECRET_KEY}  # Must be set in production environment
    site-key: ${RECAPTCHA_SITE_KEY}     # Reference only - used by frontend
    verify-url: ${RECAPTCHA_VERIFY_URL:https://www.google.com/recaptcha/api/siteverify}
    min-score: ${RECAPTCHA_MIN_SCORE:0.7}  # Higher threshold for production
    timeout-ms: ${RECAPTCHA_TIMEOUT_MS:5000}
    actions:
      login: ${RECAPTCHA_ACTION_LOGIN:login}
      verify-otp: ${RECAPTCHA_ACTION_VERIFY_OTP:verify_otp}
      resend-otp: ${RECAPTCHA_ACTION_RESEND_OTP:resend_otp}
