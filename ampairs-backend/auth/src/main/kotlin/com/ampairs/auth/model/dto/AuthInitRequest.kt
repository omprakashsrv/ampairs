package com.ampairs.auth.model.dto

import com.ampairs.core.validation.SafeString
import com.ampairs.core.validation.ValidCountryCode
import com.ampairs.core.validation.ValidPhone
import jakarta.validation.constraints.NotBlank
import jakarta.validation.constraints.NotNull
import jakarta.validation.constraints.Size


data class AuthInitRequest(

    @field:NotNull(message = "Country code is required")
    @field:ValidCountryCode
    val countryCode: Int = 91,

    @field:NotNull(message = "Phone number is required")
    @field:NotBlank(message = "Phone number cannot be blank")
    @field:ValidPhone
    val phone: String = "",

    @field:SafeString(maxLength = 1000, message = "reCAPTCHA token contains invalid characters")
    val recaptchaToken: String? = null,

    @field:SafeString(maxLength = 100, message = "Device ID contains invalid characters")
    @field:Size(max = 100, message = "Device ID cannot exceed 100 characters")
    val deviceId: String? = null, // For mobile apps, generated by client; for web, will be generated server-side

    @field:SafeString(maxLength = 100, message = "Device name contains invalid characters")
    @field:Size(max = 100, message = "Device name cannot exceed 100 characters")
    val deviceName: String? = null, // e.g., "iPhone 15", "John's MacBook"

    @field:SafeString(maxLength = 50, message = "Device type contains invalid characters")
    @field:Size(max = 50, message = "Device type cannot exceed 50 characters")
    val deviceType: String? = null, // "Mobile", "Tablet", "Desktop"

    @field:SafeString(maxLength = 50, message = "Platform contains invalid characters")
    @field:Size(max = 50, message = "Platform cannot exceed 50 characters")
    val platform: String? = null, // "iOS", "Android", "Windows", "macOS", "Linux"

    @field:SafeString(maxLength = 100, message = "Browser contains invalid characters")
    @field:Size(max = 100, message = "Browser cannot exceed 100 characters")
    val browser: String? = null, // "Google Chrome", "Safari", "Firefox", etc.

    @field:SafeString(maxLength = 100, message = "OS contains invalid characters")
    @field:Size(max = 100, message = "OS cannot exceed 100 characters")
    val os: String? = null, // "iOS 17.1", "Android 14", "Windows 11", etc.

) {
    fun phoneNumber(): String = "$countryCode$phone"
}

