/*
 * Ampairs Material Design 3 System
 * Modern theming with M3 color tokens, typography, and density support
 */

// Angular Material core
@use '@angular/material' as mat;

// Import comprehensive M3 theme system from src/theme
@use 'theme/theme' as theme;
@use 'theme/variables' as vars;
@use 'theme/fonts' as fonts;
@use 'theme/spacing' as spacing;
@use 'theme/colors' as colors;
@use 'theme/common' as common;
@use 'theme/density' as density;

// Include Material core (M3 compatible)
@include mat.core();

// Import theme definitions - use updated theme references
$light-theme: theme.$light-theme;
$dark-theme: theme.$dark-theme;

// ================================
// Material 3 Theme Application
// ================================

// Apply M3 light theme as default
@include mat.all-component-themes($light-theme);

// ================================  
// Material 3 Theme Classes
// ================================

.light-theme {
  @include mat.all-component-colors($light-theme);

  // M3 Design Tokens for light theme
  --primary-color: var(--app-light-primary);
  --primary-container-color: var(--app-light-primary-container);
  --on-primary-color: var(--app-light-on-primary);
  --on-primary-container-color: var(--app-light-on-primary-container);
  
  --secondary-color: var(--app-light-secondary);
  --secondary-container-color: var(--app-light-secondary-container);
  --on-secondary-color: var(--app-light-on-secondary);
  --on-secondary-container-color: var(--app-light-on-secondary-container);
  
  --tertiary-color: var(--app-light-tertiary);
  --tertiary-container-color: var(--app-light-tertiary-container);
  --on-tertiary-color: var(--app-light-on-tertiary);
  --on-tertiary-container-color: var(--app-light-on-tertiary-container);
  
  --surface-color: var(--app-light-surface);
  --surface-container-color: var(--app-light-surface-container);
  --surface-container-low-color: var(--app-light-surface-container-low);
  --surface-container-high-color: var(--app-light-surface-container-high);
  --surface-container-highest-color: var(--app-light-surface-container-highest);
  --on-surface-color: var(--app-light-on-surface);
  --on-surface-variant-color: var(--app-light-on-surface-variant);
  
  --background-color: var(--app-light-background);
  --on-background-color: var(--app-light-on-background);
  
  --error-color: var(--app-light-error);
  --error-container-color: var(--app-light-error-container);
  --on-error-color: var(--app-light-on-error);
  --on-error-container-color: var(--app-light-on-error-container);
  
  --outline-color: var(--app-light-outline);
  --outline-variant-color: var(--app-light-outline-variant);

  // Legacy compatibility
  --accent-color: var(--app-light-secondary);
  --warn-color: var(--app-light-error);
  --success-color: var(--app-light-tertiary);
  --warning-color: var(--app-light-tertiary);
  --info-color: var(--app-light-primary);
  --text-color: var(--app-light-on-background);
  --text-secondary-color: var(--app-light-on-surface-variant);
  --text-disabled-color: color-mix(in srgb, var(--app-light-on-surface) 38%, transparent);
  --text-hint-color: color-mix(in srgb, var(--app-light-on-surface) 60%, transparent);
  --border-color: var(--app-light-outline-variant);
  --divider-color: var(--app-light-outline-variant);
  --disabled-color: var(--app-light-surface-container);
  
  // M3 Elevation shadows
  --shadow-1: 0 1px 2px color-mix(in srgb, var(--app-light-on-surface) 30%, transparent), 0 1px 3px 1px color-mix(in srgb, var(--app-light-on-surface) 15%, transparent);
  --shadow-2: 0 1px 2px color-mix(in srgb, var(--app-light-on-surface) 30%, transparent), 0 2px 6px 2px color-mix(in srgb, var(--app-light-on-surface) 15%, transparent);
  --shadow-3: 0 4px 8px 3px color-mix(in srgb, var(--app-light-on-surface) 15%, transparent), 0 1px 3px color-mix(in srgb, var(--app-light-on-surface) 30%, transparent);
  --shadow-4: 0 6px 10px 4px color-mix(in srgb, var(--app-light-on-surface) 15%, transparent), 0 2px 3px color-mix(in srgb, var(--app-light-on-surface) 30%, transparent);
}

.dark-theme {
  @include mat.all-component-colors($dark-theme);

  // M3 Design Tokens for dark theme
  --primary-color: var(--app-dark-primary);
  --primary-container-color: var(--app-dark-primary-container);
  --on-primary-color: var(--app-dark-on-primary);
  --on-primary-container-color: var(--app-dark-on-primary-container);
  
  --secondary-color: var(--app-dark-secondary);
  --secondary-container-color: var(--app-dark-secondary-container);
  --on-secondary-color: var(--app-dark-on-secondary);
  --on-secondary-container-color: var(--app-dark-on-secondary-container);
  
  --tertiary-color: var(--app-dark-tertiary);
  --tertiary-container-color: var(--app-dark-tertiary-container);
  --on-tertiary-color: var(--app-dark-on-tertiary);
  --on-tertiary-container-color: var(--app-dark-on-tertiary-container);
  
  --surface-color: var(--app-dark-surface);
  --surface-container-color: var(--app-dark-surface-container);
  --surface-container-low-color: var(--app-dark-surface-container-low);
  --surface-container-high-color: var(--app-dark-surface-container-high);
  --surface-container-highest-color: var(--app-dark-surface-container-highest);
  --on-surface-color: var(--app-dark-on-surface);
  --on-surface-variant-color: var(--app-dark-on-surface-variant);
  
  --background-color: var(--app-dark-background);
  --on-background-color: var(--app-dark-on-background);
  
  --error-color: var(--app-dark-error);
  --error-container-color: var(--app-dark-error-container);
  --on-error-color: var(--app-dark-on-error);
  --on-error-container-color: var(--app-dark-on-error-container);
  
  --outline-color: var(--app-dark-outline);
  --outline-variant-color: var(--app-dark-outline-variant);

  // Legacy compatibility
  --accent-color: var(--app-dark-secondary);
  --warn-color: var(--app-dark-error);
  --success-color: var(--app-dark-tertiary);
  --warning-color: var(--app-dark-tertiary);
  --info-color: var(--app-dark-primary);
  --text-color: var(--app-dark-on-background);
  --text-secondary-color: var(--app-dark-on-surface-variant);
  --text-disabled-color: color-mix(in srgb, var(--app-dark-on-surface) 38%, transparent);
  --text-hint-color: color-mix(in srgb, var(--app-dark-on-surface) 60%, transparent);
  --border-color: var(--app-dark-outline-variant);
  --divider-color: var(--app-dark-outline-variant);
  --disabled-color: var(--app-dark-surface-container);
  
  // M3 Elevation shadows for dark theme
  --shadow-1: 0 1px 2px color-mix(in srgb, black 30%, transparent), 0 1px 3px 1px color-mix(in srgb, black 15%, transparent);
  --shadow-2: 0 1px 2px color-mix(in srgb, black 30%, transparent), 0 2px 6px 2px color-mix(in srgb, black 15%, transparent);
  --shadow-3: 0 4px 8px 3px color-mix(in srgb, black 15%, transparent), 0 1px 3px color-mix(in srgb, black 30%, transparent);
  --shadow-4: 0 6px 10px 4px color-mix(in srgb, black 15%, transparent), 0 2px 3px color-mix(in srgb, black 30%, transparent);
}


// ================================
// Base Styles
// ================================

html, body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: var(--font-family, 'Roboto', 'Helvetica Neue', sans-serif), serif;
  font-size: var(--font-size-medium, 14px);
}

body {
  background-color: var(--background-color);
  color: var(--text-color);
  line-height: 1.6;
  // M3 typography is handled by the theme system
}

// ================================
// Material 3 Design System
// ================================

// ================================
// Apply Comprehensive Theme System
// ================================

// Apply font tokens from src/theme/fonts.scss
// These provide responsive typography that adapts to user preferences
body {
  &.font-xs { @extend .font-xs; }
  &.font-s { @extend .font-s; }
  &.font-m { @extend .font-m; }
  &.font-l { @extend .font-l; }
  &.font-xl { @extend .font-xl; }
}

// Apply spacing tokens from src/theme/spacing.scss  
// These provide responsive spacing that adapts to density settings
body {
  &.spacing-xs { @extend .spacing-xs; }
  &.spacing-s { @extend .spacing-s; }
  &.spacing-m { @extend .spacing-m; }
  &.spacing-l { @extend .spacing-l; }
  &.spacing-xl { @extend .spacing-xl; }
}

// Apply density tokens from src/theme/density.scss
body {
  &.density-comfortable { @extend .density-comfortable; }
  &.density-compact { @extend .density-compact; }
  &.density-cozy { @extend .density-cozy; }
}

// Apply common theme utilities
body { @extend .common-theme; }

// Apply font system by default (font-m is the baseline)
body { @extend .font-common, .font-m; }

// Apply spacing system by default (spacing-m is the baseline)
body { @extend .spacing-m; }

// ================================
// Material 3 Dynamic Density Classes  
// ================================

// M3 Density classes for runtime theme switching
.mat-density--5 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: -5)
  )));
}
.mat-density--4 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: -4)
  )));
}
.mat-density--3 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: -3)
  )));
}
.mat-density--2 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: -2)
  )));
}
.mat-density--1 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: -1)
  )));
}
.mat-density-0 { 
  @include mat.all-component-themes(mat.define-theme((
    density: (scale: 0)
  )));
}

// Theme-aware snackbar variants (using design tokens)
.success-snackbar {
  --mdc-snackbar-container-color: var(--success-color);
  --mdc-snackbar-supporting-text-color: var(--on-tertiary-color);
  --mat-snack-bar-button-color: var(--on-tertiary-color);
}

.error-snackbar {
  --mdc-snackbar-container-color: var(--warn-color);
  --mdc-snackbar-supporting-text-color: var(--on-error-color);
  --mat-snack-bar-button-color: var(--on-error-color);
}

.warning-snackbar {
  --mdc-snackbar-container-color: var(--warning-color);
  --mdc-snackbar-supporting-text-color: var(--on-tertiary-color);
  --mat-snack-bar-button-color: var(--on-tertiary-color);
}

.info-snackbar {
  --mdc-snackbar-container-color: var(--info-color);
  --mdc-snackbar-supporting-text-color: var(--on-primary-color);
  --mat-snack-bar-button-color: var(--on-primary-color);
}

// ================================
// Utility Classes
// ================================

// Typography utilities using M3 tokens
.text-display-large { font: var(--mat-sys-display-large); }
.text-display-medium { font: var(--mat-sys-display-medium); }
.text-display-small { font: var(--mat-sys-display-small); }
.text-headline-large { font: var(--mat-sys-headline-large); }
.text-headline-medium { font: var(--mat-sys-headline-medium); }
.text-headline-small { font: var(--mat-sys-headline-small); }
.text-title-large { font: var(--mat-sys-title-large); }
.text-title-medium { font: var(--mat-sys-title-medium); }
.text-title-small { font: var(--mat-sys-title-small); }
.text-body-large { font: var(--mat-sys-body-large); }
.text-body-medium { font: var(--mat-sys-body-medium); }
.text-body-small { font: var(--mat-sys-body-small); }
.text-label-large { font: var(--mat-sys-label-large); }
.text-label-medium { font: var(--mat-sys-label-medium); }
.text-label-small { font: var(--mat-sys-label-small); }

// Spacing utilities using M3 tokens
.p-xs { padding: var(--mat-sys-spacing-x-small); }
.p-sm { padding: var(--mat-sys-spacing-small); }
.p-md { padding: var(--mat-sys-spacing-medium); }
.p-lg { padding: var(--mat-sys-spacing-large); }
.p-xl { padding: var(--mat-sys-spacing-x-large); }
.p-2xl { padding: var(--mat-sys-spacing-xx-large); }
.p-3xl { padding: var(--mat-sys-spacing-xxx-large); }

.m-xs { margin: var(--mat-sys-spacing-x-small); }
.m-sm { margin: var(--mat-sys-spacing-small); }
.m-md { margin: var(--mat-sys-spacing-medium); }
.m-lg { margin: var(--mat-sys-spacing-large); }
.m-xl { margin: var(--mat-sys-spacing-x-large); }
.m-2xl { margin: var(--mat-sys-spacing-xx-large); }
.m-3xl { margin: var(--mat-sys-spacing-xxx-large); }

// Gap utilities for flexbox/grid
.gap-xs { gap: var(--mat-sys-spacing-x-small); }
.gap-sm { gap: var(--mat-sys-spacing-small); }
.gap-md { gap: var(--mat-sys-spacing-medium); }
.gap-lg { gap: var(--mat-sys-spacing-large); }
.gap-xl { gap: var(--mat-sys-spacing-x-large); }
.gap-2xl { gap: var(--mat-sys-spacing-xx-large); }
.gap-3xl { gap: var(--mat-sys-spacing-xxx-large); }

// Color utilities
.text-primary {
  color: var(--primary-color);
}

.text-accent {
  color: var(--accent-color);
}

.text-warn {
  color: var(--warn-color);
}

.text-success {
  color: var(--success-color);
}

.text-warning {
  color: var(--warning-color);
}

.text-info {
  color: var(--info-color);
}

.text-secondary {
  color: var(--text-secondary-color);
}

.text-disabled {
  color: var(--text-disabled-color);
}

.bg-primary {
  background-color: var(--primary-color);
}

.bg-accent {
  background-color: var(--accent-color);
}

.bg-surface {
  background-color: var(--surface-color);
}

.bg-background {
  background-color: var(--background-color);
}

// Layout utilities
.full-width {
  width: 100%;
}

.full-height {
  height: 100%;
}

.flex {
  display: flex;
}

.flex-column {
  flex-direction: column;
}

.flex-row {
  flex-direction: row;
}

.flex-wrap {
  flex-wrap: wrap;
}

.justify-start {
  justify-content: flex-start;
}

.justify-center {
  justify-content: center;
}

.justify-end {
  justify-content: flex-end;
}

.justify-between {
  justify-content: space-between;
}

.justify-around {
  justify-content: space-around;
}

.items-start {
  align-items: flex-start;
}

.items-center {
  align-items: center;
}

.items-end {
  align-items: flex-end;
}

.items-stretch {
  align-items: stretch;
}

.self-start {
  align-self: flex-start;
}

.self-center {
  align-self: center;
}

.self-end {
  align-self: flex-end;
}

// Text alignment
.text-left {
  text-align: left;
}

.text-center {
  text-align: center;
}

.text-right {
  text-align: right;
}

.text-justify {
  text-align: justify;
}

// Border radius utilities - now using M3 corner tokens
.rounded-none {
  border-radius: var(--mat-sys-corner-none);
}

.rounded-sm {
  border-radius: var(--mat-sys-corner-extra-small);
}

.rounded {
  border-radius: var(--mat-sys-corner-small);
}

.rounded-lg {
  border-radius: var(--mat-sys-corner-medium);
}

.rounded-xl {
  border-radius: var(--mat-sys-corner-large);
}

.rounded-full {
  border-radius: var(--mat-sys-corner-full);
}

// Shadow utilities
.shadow-none {
  box-shadow: none;
}

.shadow-sm {
  box-shadow: var(--shadow-1);
}

.shadow {
  box-shadow: var(--shadow-2);
}

.shadow-md {
  box-shadow: var(--shadow-3);
}

.shadow-lg {
  box-shadow: var(--shadow-4);
}

// ================================
// Animations
// ================================

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(24px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInDown {
  from {
    opacity: 0;
    transform: translateY(-24px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes scaleIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.animate-fade-in {
  animation: fadeIn 0.3s ease-out;
}

.animate-slide-in-up {
  animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-slide-in-down {
  animation: slideInDown 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.animate-scale-in {
  animation: scaleIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

// ================================
// Responsive Design
// ================================

// Mobile-first responsive utilities
@media (min-width: vars.$breakpoint-sm) {
  .sm\:flex {
    display: flex;
  }
  .sm\:hidden {
    display: none;
  }
  .sm\:block {
    display: block;
  }
}

@media (min-width: vars.$breakpoint-md) {
  .md\:flex {
    display: flex;
  }
  .md\:hidden {
    display: none;
  }
  .md\:block {
    display: block;
  }
}

@media (min-width: vars.$breakpoint-lg) {
  .lg\:flex {
    display: flex;
  }
  .lg\:hidden {
    display: none;
  }
  .lg\:block {
    display: block;
  }
}

// Hide on mobile
@media (max-width: vars.$breakpoint-sm - 1px) {
  .hide-on-mobile {
    display: none;
  }
}

// Hide on desktop
@media (min-width: vars.$breakpoint-md) {
  .hide-on-desktop {
    display: none;
  }
}

// Reduced motion support
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
