<div class="home-container">
    <!-- Header -->
    <mat-toolbar class="header-toolbar">
    <span class="logo">
      <mat-icon class="logo-icon">business</mat-icon>
      Ampairs
    </span>

      <!-- Workspace Info -->
      @if (currentWorkspace$ | async; as workspace) {
        <div class="workspace-info">
          <button mat-button [matMenuTriggerFor]="workspaceMenu" class="workspace-button">
            <mat-icon>business</mat-icon>
            <span class="workspace-name">{{ workspace.name }}</span>
            <mat-icon class="dropdown-icon">arrow_drop_down</mat-icon>
          </button>

          <mat-menu #workspaceMenu="matMenu" class="workspace-menu">
            <div class="workspace-details">
              <div class="workspace-header">
                <mat-icon>business</mat-icon>
                <div class="workspace-info-text">
                  <h3 class="workspace-title">{{ workspace.name }}</h3>
                  <p class="workspace-slug">@{{ workspace.slug }}</p>
                </div>
              </div>
              @if (workspace.description) {
                <p class="workspace-description">{{ workspace.description }}</p>
              }
            </div>

            <mat-divider></mat-divider>

            <button mat-menu-item (click)="manageMembers()">
              <mat-icon>people</mat-icon>
              <span>Manage Members</span>
            </button>

            <button mat-menu-item (click)="manageModules()">
              <mat-icon>extension</mat-icon>
              <span>Manage Modules</span>
            </button>

            <mat-divider></mat-divider>

            <button mat-menu-item (click)="switchWorkspace()">
              <mat-icon>swap_horiz</mat-icon>
              <span>Switch Workspace</span>
            </button>
          </mat-menu>
        </div>
      }

      <span class="spacer"></span>

        <!-- Theme Toggle Button -->
        <button mat-icon-button (click)="toggleTheme()" matTooltip="Toggle Theme">
            <mat-icon>palette</mat-icon>
        </button>

        <!-- Theme Settings Button -->
        <button mat-icon-button (click)="openThemeSettings()" matTooltip="Theme Settings">
            <mat-icon>tune</mat-icon>
        </button>

        <!-- User Profile Menu -->
        @if (currentUser$ | async; as user) {
            <div class="user-profile">
                <button mat-icon-button [matMenuTriggerFor]="userMenu">
                    <mat-icon>account_circle</mat-icon>
                </button>

                <mat-menu #userMenu="matMenu" class="user-menu">
                    <div class="user-info">
                        <mat-icon>account_circle</mat-icon>
                        <div class="user-details">
                            <h3 class="user-name">{{ user.full_name || 'User' }}</h3>
                            <p class="user-mobile">+91 {{ user.phone }}</p>
                            @if (user.email) {
                                <p class="user-email">{{ user.email }}</p>
                            }
                        </div>
                    </div>

                    <mat-divider></mat-divider>

                    <button mat-menu-item (click)="editProfile()">
                        <mat-icon>edit</mat-icon>
                        <span>Edit Profile</span>
                    </button>

                    <button mat-menu-item (click)="viewSettings()">
                        <mat-icon>settings</mat-icon>
                        <span>Settings</span>
                    </button>

                    <button (click)="viewDevices()" mat-menu-item>
                        <mat-icon>devices</mat-icon>
                        <span>Device Sessions</span>
                    </button>

                    <mat-divider></mat-divider>

                    <button mat-menu-item (click)="logout()">
                        <mat-icon>logout</mat-icon>
                        <span>Logout</span>
                    </button>
                </mat-menu>
            </div>
        }
    </mat-toolbar>

    <!-- Main Content -->
    <div class="main-content">
        <router-outlet></router-outlet>
    </div>
</div>
